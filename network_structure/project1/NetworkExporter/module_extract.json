{
	"name": "module_extract",
	"OPType": "textDAT",
	"comment": "",
	"storage": {},
	"tags": [],
	"replicator": null,
	"activeViewer": false,
	"allowCooking": true,
	"bypass": false,
	"cloneImmune": false,
	"render": false,
	"viewer": true,
	"inputConnectors": [
		{}
	],
	"outputConnectors": [
		{}
	],
	"par": [],
	"text": [
		"import TDStoreTools",
		"",
		"def extractAttr(attr):",
		"\tif isinstance(attr,list):",
		"\t\treturn [extractAttr(a) for a in attr]",
		"\tif isinstance(attr,dict):",
		"\t\treturn {k:extractAttr(v) for k,v in attr}",
		"\tif isinstance(attr,set):",
		"\t\treturn [extractAttr(a) for a in attr]",
		"\tif isinstance(attr,TDStoreTools.DependSet):",
		"\t\treturn extractAttr(attr.getRaw())",
		"\tif isinstance(attr, OP):",
		"\t\treturn attr.path",
		"\tif isinstance(attr,ParMode):",
		"\t\treturn attr.name",
		"\tif isinstance(attr,Channel):",
		"\t\treturn attr.name",
		"\tif isinstance(attr,Cell):",
		"\t\treturn [attr.col, attr.row]",
		"\tif isinstance(attr,Connector):",
		"\t\treturn {extractAttr(conn.owner):conn.index for conn in attr.connections} if len(attr.connections) > 0 else {}",
		"\treturn attr",
		"",
		"",
		"",
		"def extractPar(par):",
		"\treturn {arg: extractAttr(getattr(par,arg)) for arg in [",
		"\t\t'name','val',",
		"\t\t'expr','enableExpr',",
		"\t\t'exportOP','exportSource',",
		"\t\t'bindExpr','bindReferences',",
		"\t\t'mode'",
		"\t]}",
		"",
		"def extractOp(o):",
		"\tret = {arg: extractAttr(getattr(o,arg)) for arg in [",
		"\t\t'name', 'OPType',",
		"\t\t'comment',",
		"\t\t'storage', 'tags',",
		"\t\t'replicator',",
		"\t\t'activeViewer', 'allowCooking', 'bypass', 'cloneImmune', 'render', 'viewer',",
		"\t\t'inputConnectors', 'outputConnectors'",
		"\t]}",
		"\tret['par'] = [extractPar(par) for par in o.pars() if par.isCustom or not par.isDefault]\t",
		"\tif o.isDAT:",
		"\t\tret['text'] = o.text.splitlines() if o.isText else [line.split('\\t') for line in o.text.splitlines()]",
		"\treturn ret"
	]
}